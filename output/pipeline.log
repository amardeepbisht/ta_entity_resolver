2025-06-05 19:28:51,791 - INFO - Loading configuration from d:\MyFiles\ER\ta_entity_resolver\resolver_config\config.yaml
2025-06-05 19:28:51,799 - INFO - Configuration loaded successfully
2025-06-05 19:28:51,799 - INFO - Starting orchestration in main.py
2025-06-05 19:28:51,799 - INFO - Loading data from sample_data/input/restaurants_100.csv using engine: pandas and format: csv
2025-06-05 19:28:51,816 - INFO - Pandas loaded file successfully with shape: (98, 5)
2025-06-05 19:28:51,816 - INFO - Loaded input (sample_data/input/restaurants_100.csv) -> 98 rows, 5 cols
2025-06-05 19:28:51,816 - INFO - Input loading completed in 0.02 seconds
2025-06-05 19:28:51,839 - INFO - Saved preprocessed data to output\preprocessed_data.csv
2025-06-05 19:28:51,840 - INFO - After preprocessing -> 98 rows remain
2025-06-05 19:28:51,840 - INFO - Preprocessing completed in 0.05 seconds
2025-06-05 19:28:51,983 - INFO - Running Fuzzy Matcher...
2025-06-05 19:28:51,983 - INFO - Enabled algorithms: ['levenshtein', 'jaro_winkler', 'token_set_ratio']
2025-06-05 19:28:51,983 - INFO - Matching fields: [('name', 0.8, 1.0), ('address', 0.85, 1.0), ('city', 0.85, 1.0)]
2025-06-05 19:28:51,987 - INFO - Running algorithm 'levenshtein'
2025-06-05 19:28:52,017 - INFO - [levenshtein] Completed 4753 comparisons. Matches: 27; Below threshold: 4726
2025-06-05 19:28:52,034 - INFO - [levenshtein] Saved fuzzy matcher output to output\fuzzy_matcher_levenshtein.csv
2025-06-05 19:28:52,034 - INFO - Running algorithm 'jaro_winkler'
2025-06-05 19:28:52,064 - INFO - [jaro_winkler] Completed 4753 comparisons. Matches: 50; Below threshold: 4703
2025-06-05 19:28:52,084 - INFO - [jaro_winkler] Saved fuzzy matcher output to output\fuzzy_matcher_jaro_winkler.csv
2025-06-05 19:28:52,084 - INFO - Running algorithm 'token_set_ratio'
2025-06-05 19:28:52,127 - INFO - [token_set_ratio] Completed 4753 comparisons. Matches: 41; Below threshold: 4712
2025-06-05 19:28:52,146 - INFO - [token_set_ratio] Saved fuzzy matcher output to output\fuzzy_matcher_token_set_ratio.csv
2025-06-05 19:28:52,149 - INFO - Matcher execution completed in 0.36 seconds
2025-06-05 19:28:52,149 - INFO - Running simple ensemble (pre-advanced).
2025-06-05 19:28:52,149 - INFO - Aggregation method: weighted_average, Threshold: 0.7500
2025-06-05 19:28:52,150 - INFO - Matcher Weights: {'fuzzy_matcher': 0.4, 'spark_matcher': 0.3, 'graph_matcher': 0.3}
2025-06-05 19:28:52,150 - INFO - Enabled fuzzy algorithms: ['levenshtein', 'jaro_winkler', 'token_set_ratio'], per-algo weight: 0.1333
2025-06-05 19:28:52,150 - INFO - Fuzzy score columns found: ['levenshtein_score', 'jaro_winkler_score', 'token_set_ratio_score']
2025-06-05 19:28:52,153 - INFO - Collected 51 unique record pairs from matcher outputs.
2025-06-05 19:28:52,171 - INFO - Saved final ensembled pairs to output/final_results.csv (51 rows)
2025-06-05 19:28:52,194 - INFO - Saved 51 LLM-input JSON lines to output\for_llm.jsonl
2025-06-05 19:28:52,194 - INFO - Ensembling completed in 0.40 seconds
2025-06-05 19:28:52,210 - INFO - Saved final ensembled pairs to output/final_results.csv (51 rows)
2025-06-05 19:28:52,226 - INFO - Saved full summary report to output/report_summary.txt
2025-06-05 19:28:52,227 - INFO - Running LLM Validation on final matched pairs...
2025-06-05 19:28:55,954 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:28:57,113 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:28:58,796 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:28:59,884 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:01,339 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:02,262 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:03,615 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:04,991 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:06,330 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:07,488 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:08,577 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:12,424 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:13,877 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:14,937 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:17,519 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:18,601 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:19,901 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:22,142 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:23,570 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:24,581 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:25,645 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:27,331 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:28,619 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:29,999 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:31,427 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:35,412 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:36,799 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:37,897 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:39,007 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:40,157 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:41,190 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:42,865 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:44,434 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:44,469 - INFO - LLM validated results (JSON) written to: output/llm_validated_results.jsonl
2025-06-05 19:29:44,492 - INFO - Successfully wrote flattened CSV to: output/llm_validated_results.csv
2025-06-05 19:29:44,492 - INFO - LLM validated results (CSV) written to: output/llm_validated_results.csv
2025-06-05 19:29:44,493 - INFO - LLM validation completed in 52.70 seconds
2025-06-05 19:29:44,493 - INFO - Running Report Generation based on pipeline log...
2025-06-05 19:29:44,493 - INFO - Parsing pipeline log: output/pipeline.log
2025-06-05 19:29:44,508 - INFO - Initializing AzureChatOpenAI client with deployment: gpt-4o-mini
2025-06-05 19:29:45,386 - INFO - Calling LLM to generate summary report
2025-06-05 19:29:48,994 - INFO - HTTP Request: POST https://openai-datafabric-dev-001.openai.azure.com/openai/deployments/gpt-4o-mini/chat/completions?api-version=2024-02-01 "HTTP/1.1 200 OK"
2025-06-05 19:29:48,995 - INFO - Received summary report from LLM
2025-06-05 19:29:49,004 - INFO - Saved LLM summary report to: output/llm_summary_report.txt
2025-06-05 19:29:49,005 - INFO - Report Generation completed in 57.21 seconds
